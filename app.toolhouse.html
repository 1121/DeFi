<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Beefy BNB-BUSD Vault Front-End</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; max-width: 400px; margin: 2em auto; background: #f9f9f9; padding: 2em; border-radius: 8px; }
    h2 { color: #4e44ce; }
    input, button { margin: 0.5em 0; width: 100%; padding: 0.5em; }
    #status { margin-top: 1em; min-height: 2em; }
  </style>
</head>
<body>
  <h2>Beefy BNB-BUSD Vault</h2>
  <button id="connect">Connect Wallet</button>
  <div id="wallet"></div>
  <input id="amount" type="number" placeholder="Amount of LP tokens" min="0" step="any">
  <button id="approve" disabled>Approve</button>
  <button id="deposit" disabled>Deposit</button>
  <button id="withdraw" disabled>Withdraw</button>
  <div id="status"></div>

  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
  <script>
    let web3;
    let account;
    const vaultAddress = '0xD7D069493685A581d27824Fc46EdA46B7EfC0063'; // Beefy BNB-BUSD vault
    const vaultABI = [
      {
        "inputs": [{"internalType": "uint256","name": "_amount","type": "uint256"}],
        "name": "deposit",
        "outputs": [],
        "stateMutability": "nonpayable",
        "type": "function"
      },
      {
        "inputs": [{"internalType": "uint256","name": "_shares","type": "uint256"}],
        "name": "withdraw",
        "outputs": [],
        "stateMutability": "nonpayable",
        "type": "function"
      }
    ];
    const tokenAddress = '0x1b96b92314c44b159149f7e0303511fb2fc4774f'; // PancakeSwap BNB-BUSD LP token
    const erc20ABI = [
      {"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function"},
      {"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_spender","type":"address"}],"name":"allowance","outputs":[{"name":"","type":"uint256"}],"type":"function"},
      {"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"","type":"uint256"}],"type":"function"}
    ];
    let vault, token;

    document.getElementById('connect').onclick = async () => {
      if (window.ethereum) {
        web3 = new Web3(window.ethereum);
        try {
          const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
          account = accounts[0];
          document.getElementById('wallet').innerText = 'Connected: ' + account;
          vault = new web3.eth.Contract(vaultABI, vaultAddress);
          token = new web3.eth.Contract(erc20ABI, tokenAddress);
          document.getElementById('approve').disabled = false;
          document.getElementById('deposit').disabled = false;
          document.getElementById('withdraw').disabled = false;
        } catch (err) {
          document.getElementById('status').innerText = 'Connection rejected.';
        }
      } else {
        document.getElementById('status').innerText = 'MetaMask not found!';
      }
    };

    document.getElementById('approve').onclick = async () => {
      const amount = web3.utils.toWei(document.getElementById('amount').value, 'ether');
      document.getElementById('status').innerText = 'Approving...';
      try {
        await token.methods.approve(vaultAddress, amount).send({ from: account });
        document.getElementById('status').innerText = 'Approved!';
      } catch (err) {
        document.getElementById('status').innerText = 'Approve failed: ' + err.message;
      }
    };

    document.getElementById('deposit').onclick = async () => {
      const amount = web3.utils.toWei(document.getElementById('amount').value, 'ether');
      document.getElementById('status').innerText = 'Depositing...';
      try {
        await vault.methods.deposit(amount).send({ from: account });
        document.getElementById('status').innerText = 'Deposit successful!';
      } catch (err) {
        document.getElementById('status').innerText = 'Deposit failed: ' + err.message;
      }
    };

    document.getElementById('withdraw').onclick = async () => {
      const amount = web3.utils.toWei(document.getElementById('amount').value, 'ether');
      document.getElementById('status').innerText = 'Withdrawing...';
      try {
        await vault.methods.withdraw(amount).send({ from: account });
        document.getElementById('status').innerText = 'Withdraw successful!';
      } catch (err) {
        document.getElementById('status').innerText = 'Withdraw failed: ' + err.message;
      }
    };
  </script>
</body>
</html>
